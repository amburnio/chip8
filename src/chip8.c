#include "chip8.h"

/** DATA **/

unsigned char chip8_font_set[80] = {
    0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
    0x20, 0x60, 0x20, 0x20, 0x70, // 1
    0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
    0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
    0x90, 0x90, 0xF0, 0x10, 0x10, // 4
    0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
    0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
    0xF0, 0x10, 0x20, 0x40, 0x40, // 7
    0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
    0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
    0xF0, 0x90, 0xF0, 0x90, 0x90, // A
    0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
    0xF0, 0x80, 0x80, 0x80, 0xF0, // C
    0xE0, 0x90, 0x90, 0x90, 0xE0, // D
    0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
    0xF0, 0x80, 0xF0, 0x80, 0x80  // F
};

/** FUNCTIONS **/

void initialize(chip8 core) {
    core.pc = 0x200;
    core.opcode = 0;
    core.I = 0;
    core.sp = 0;
    core.delay_timer = 0;
    core.sound_timer = 0;

    // Clear display
    for (int i = 0; i < (64 * 32); ++i) {
        core.gfx[i] = 0;
    }

    // Clear stack, registers V0-VF, and key state
    for (int i = 0; i < 16; ++i) {
        core.stack[i] = 0;
        core.V[i] = 0;
        core.key[i] = 0;
    }

    // Clear memory
    for (int i = 0; i < 4096; ++i) {
        core.memory[i] = 0;
    }

    // Load font set
    for (int i = 0; i < 80; ++i) {
        core.memory[i] = chip8_font_set[i];
    }
}